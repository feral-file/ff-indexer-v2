# ==============================================
# Feral File Indexer - Environment Configuration
# ==============================================
# NOTE: All variables must be prefixed with FF_INDEXER_
# Nested configs use dots converted to underscores (e.g., database.user â†’ FF_INDEXER_DATABASE_USER)

# ----------------
# General Settings
# ----------------
FF_INDEXER_DEBUG=true
FF_INDEXER_SENTRY_DSN=

# ----------------
# Database Configuration
# ----------------
FF_INDEXER_DATABASE_HOST=localhost
FF_INDEXER_DATABASE_PORT=5432
FF_INDEXER_DATABASE_READ_HOST=
FF_INDEXER_DATABASE_READ_PORT=0
FF_INDEXER_DATABASE_USER=postgres
FF_INDEXER_DATABASE_PASSWORD=postgres
FF_INDEXER_DATABASE_DBNAME=ff_indexer
FF_INDEXER_DATABASE_SSLMODE=disable

# ----------------
# Server Configuration (API)
# ----------------
FF_INDEXER_SERVER_HOST=0.0.0.0
FF_INDEXER_SERVER_PORT=8081
FF_INDEXER_SERVER_READ_TIMEOUT=15
FF_INDEXER_SERVER_WRITE_TIMEOUT=15
FF_INDEXER_SERVER_IDLE_TIMEOUT=120

# ----------------
# Authentication Configuration (API)
# ----------------
# RSA public key in PEM format for\ validating JWT Bearer tokens
# Generate key pair:
#   openssl genrsa -out private_key.pem 2048
#   openssl rsa -in private_key.pem -pubout -out public_key.pem
# Then copy the contents of public_key.pem here
FF_INDEXER_AUTH_JWT_PUBLIC_KEY=
# List of valid API keys (comma-separated)
# Generate random keys: openssl rand -hex 32
FF_INDEXER_AUTH_API_KEYS=

# ----------------
# NATS Configuration
# ----------------
FF_INDEXER_NATS_URL=nats://localhost:4222
FF_INDEXER_NATS_STREAM_NAME=BLOCKCHAIN_EVENTS
FF_INDEXER_NATS_CONSUMER_NAME=event-bridge
FF_INDEXER_NATS_CONNECTION_NAME=
FF_INDEXER_NATS_MAX_RECONNECTS=10
FF_INDEXER_NATS_RECONNECT_WAIT=2s
FF_INDEXER_NATS_ACK_WAIT=30s
FF_INDEXER_NATS_MAX_DELIVER=3

# ----------------
# Temporal Configuration
# ----------------
FF_INDEXER_TEMPORAL_HOST_PORT=localhost:7233
FF_INDEXER_TEMPORAL_NAMESPACE=default
FF_INDEXER_TEMPORAL_TOKEN_TASK_QUEUE=token-indexing
FF_INDEXER_TEMPORAL_MEDIA_TASK_QUEUE=media-indexing
FF_INDEXER_TEMPORAL_MAX_CONCURRENT_ACTIVITY_EXECUTION_SIZE=50
FF_INDEXER_TEMPORAL_WORKER_ACTIVITIES_PER_SECOND=50

# ----------------
# Ethereum Configuration
# ----------------
FF_INDEXER_ETHEREUM_WEBSOCKET_URL=
FF_INDEXER_ETHEREUM_RPC_URL=
FF_INDEXER_ETHEREUM_CHAIN_ID=eip155:1
FF_INDEXER_ETHEREUM_START_BLOCK=0

# ----------------
# Tezos Configuration
# ----------------
FF_INDEXER_TEZOS_API_URL=https://api.tzkt.io
FF_INDEXER_TEZOS_WEBSOCKET_URL=https://api.tzkt.io/v1/ws
FF_INDEXER_TEZOS_CHAIN_ID=tezos:mainnet
FF_INDEXER_TEZOS_START_LEVEL=0

# ----------------
# Vendor Configuration
# ----------------
FF_INDEXER_VENDORS_ARTBLOCKS_URL=https://artblocks-mainnet.hasura.app/v1/graphql
FF_INDEXER_VENDORS_FERALFILE_URL=https://feralfile.com/api
FF_INDEXER_VENDORS_OBJKT_URL=https://data.objkt.com/v3/graphql
FF_INDEXER_VENDORS_OBJKT_API_KEY=
FF_INDEXER_VENDORS_OPENSEA_URL=https://api.opensea.io/api/v2
FF_INDEXER_VENDORS_OPENSEA_API_KEY=

# ----------------
# Cloudflare Configuration (worker-media)
# ----------------
FF_INDEXER_CLOUDFLARE_ACCOUNT_ID=
FF_INDEXER_CLOUDFLARE_API_TOKEN=

# ----------------
# URI Configuration
# ----------------
# IPFS gateways (comma-separated)
FF_INDEXER_URI_IPFS_GATEWAYS=https://ipfs.io,https://cloudflare-ipfs.com,https://ipfs.feralfile.com,https://dweb.link,https://ipfs.filebase.io
# Arweave gateways (comma-separated)
FF_INDEXER_URI_ARWEAVE_GATEWAYS=https://arweave.net

# ----------------
# Worker Configuration
# ----------------
FF_INDEXER_ETHEREUM_TOKEN_SWEEP_START_BLOCK=10000000
FF_INDEXER_TEZOS_TOKEN_SWEEP_START_BLOCK=5000000
FF_INDEXER_BUDGETED_INDEXING_ENABLED=false
FF_INDEXER_BUDGETED_INDEXING_DEFAULT_DAILY_QUOTA=100
FF_INDEXER_ETHEREUM_OWNER_FIRST_BATCH_TARGET=20
FF_INDEXER_ETHEREUM_OWNER_SUBSEQUENT_BATCH_TARGET=3
FF_INDEXER_TEZOS_OWNER_FIRST_BATCH_TARGET=20
FF_INDEXER_TEZOS_OWNER_SUBSEQUENT_BATCH_TARGET=1

# ----------------
# File Paths
# ----------------
FF_INDEXER_BLACKLIST_PATH=tools/registry/blacklist.json
FF_INDEXER_PUBLISHER_REGISTRY_PATH=tools/registry/publisher.json

# ----------------
# Media Worker Configuration
# ----------------
FF_INDEXER_MAX_IMAGE_SIZE=10485760
FF_INDEXER_MAX_VIDEO_SIZE=314572800
FF_INDEXER_RASTERIZER_WIDTH=2048

# ----------------
# Internal Worker Configuration 
# ----------------
FF_INDEXER_WORKER_POOL_SIZE=20
FF_INDEXER_WORKER_QUEUE_SIZE=1024

# ----------------
# Sweeper Configuration
# ----------------
FF_INDEXER_MEDIA_HEATH_SWEEPER_HTTP_TIMEOUT=30
FF_INDEXER_MEDIA_HEATH_SWEEPER_BATCH_SIZE=10
FF_INDEXER_MEDIA_HEATH_SWEEPER_WORKER_POOL_SIZE=20
FF_INDEXER_MEDIA_HEATH_SWEEPER_RECHECK_AFTER=24h

# ----------------
# Rate limiter
# ----------------
FF_INDEXER_RATE_LIMITER_REDIS_ADDR=localhost:6379
FF_INDEXER_RATE_LIMITER_REDIS_DB=
FF_INDEXER_RATE_LIMITER_REDIS_PASSWORD=
FF_INDEXER_RATE_LIMITER_MAX_WORKERS=10
FF_INDEXER_RATE_LIMITER_MAX_QUEUE_SIZE=10000
FF_INDEXER_RATE_LIMITER_ENABLE_LOCAL_FALLBACK=true
FF_INDEXER_RATE_LIMITER_LOCAL_FALLBACK_MULTIPLIER=0.5
FF_INDEXER_RATE_LIMITER_PROVIDERS_TZKT_REQUESTS_PER_SECOND=10
FF_INDEXER_RATE_LIMITER_PROVIDERS_TZKT_BURST=10
FF_INDEXER_RATE_LIMITER_PROVIDERS_TZKT_MAX_QUEUE_TIME=15m
FF_INDEXER_RATE_LIMITER_PROVIDERS_OPENSEA_REQUESTS_PER_SECOND=4
FF_INDEXER_RATE_LIMITER_PROVIDERS_OPENSEA_BURST=4
FF_INDEXER_RATE_LIMITER_PROVIDERS_OPENSEA_MAX_QUEUE_TIME=15m
FF_INDEXER_RATE_LIMITER_PROVIDERS_OBJKT_REQUESTS_PER_SECOND=2
FF_INDEXER_RATE_LIMITER_PROVIDERS_OBJKT_BURST=2
FF_INDEXER_RATE_LIMITER_PROVIDERS_OBJKT_MAX_QUEUE_TIME=15m

# ----------------
# Transformation
# ----------------
FF_INDEXER_TRANSFORM_TARGET_IMAGE_SIZE=9437184
FF_INDEXER_TRANSFORM_TARGET_IMAGE_PIXELS=45000000
FF_INDEXER_TRANSFORM_MAX_IMAGE_DIMENSION=3840
FF_INDEXER_TRANSFORM_MAX_ANIMATED_IMAGE_DIMENSION=2048
FF_INDEXER_TRANSFORM_MIN_IMAGE_DIMENSION=1280
FF_INDEXER_TRANSFORM_MIN_ANIMATED_IMAGE_DIMENSION=640
FF_INDEXER_TRANSFORM_RESIZE_STEP_PERCENTAGE=25
FF_INDEXER_TRANSFORM_INITIAL_QUALITY=100
FF_INDEXER_TRANSFORM_MIN_QUALITY=60
FF_INDEXER_TRANSFORM_QUALITY_STEP=10
FF_INDEXER_TRANSFORM_MAX_INPUT_BYTES=104857600
FF_INDEXER_TRANSFORM_MAX_DECODED_PIXELS=200000000
FF_INDEXER_TRANSFORM_TRANSFORM_TIMEOUT=60s
FF_INDEXER_TRANSFORM_WORKER_CONCURRENCY=6