# Feral File Indexer Tezos Event Emitter Configuration

debug: true
sentry_dsn: ""

database:
  host: localhost
  port: 5432
  user: postgres
  password: postgres
  dbname: ff_indexer
  sslmode: disable
  # Connection pool settings - adjust based on event emission rate
  # Event emitters primarily write block cursors, lower pool size is usually sufficient
  max_open_conns: 15        # Maximum number of open connections (default: 25)
  max_idle_conns: 3         # Maximum number of idle connections (default: 5)
  conn_max_lifetime: 5m      # Maximum time a connection can be reused (default: 5m)
  conn_max_idle_time: 10m   # Maximum time a connection can be idle (default: 10m)

nats:
  url: nats://localhost:4222
  stream_name: BLOCKCHAIN_EVENTS
  max_reconnects: 10
  reconnect_wait: 2s
  connection_name: tezos-event-emitter

tezos:
  api_url: https://api.tzkt.io
  websocket_url: https://api.tzkt.io/v1/ws
  chain_id: tezos:mainnet
  start_level: 0
  block_head_ttl: 10
  block_head_stale_window: 60

rate_limiter:
  redis_addr: :6379
  redis_password:
  redis_db:
  redis_key_prefix:
  max_workers: 10
  max_queue_size: 1000
  enable_local_fallback: true
  local_fallback_multiplier: 0.5
  providers:
    tzkt:
      requests_per_second: 10
      burst: 10
      max_queue_time: 5m

worker:
  pool_size: 20
  queue_size: 1024